$(document).ready(function(){const e=$("#start-record"),t=e.parent(),o=document.querySelectorAll('input[name = "gender"]'),a=document.getElementById("age"),r=document.getElementById("mother-tongue"),n=$("#username"),i=n.next(),s=$("#tnc"),l=/^[6-9]\d{9}$/,d=/^\S+@\S+[\.][0-9a-z]+$/,c=$("#speaker-data"),u=c.find("#loader1,#loader2"),g=c.find("#speakers-wrapper"),p=c.find("#speaker-value"),m=c.find("#hours-wrapper"),h=c.find("#hour-value"),v=e=>l.test(e)||d.test(e),f=()=>{n.val().length>11?(n.tooltip("enable"),n.tooltip("show")):(n.tooltip("disable"),n.tooltip("hide"))},k=()=>{const e=n.val().trim();v(e)?(n.addClass("is-invalid"),i.removeClass("d-none")):(n.removeClass("is-invalid"),i.addClass("d-none")),s.trigger("change"),f()};n.tooltip({container:"body",placement:screen.availWidth>500?"right":"auto",trigger:"focus"}),f(),s.prop("checked",!1),t.tooltip({container:"body",placement:screen.availWidth>500?"right":"auto"});const b=localStorage.getItem("speakerDetails");if(b){const e=JSON.parse(b),t=document.querySelector('input[name = "gender"][value="'+e.gender+'"]');t&&(t.checked=!0,t.previous=!0),a.value=e.age,r.value=e.motherTongue,n.val(e.userName?e.userName.trim().substring(0,12):""),k()}o.forEach(e=>{e.addEventListener("click",e=>{e.target.previous&&(e.target.checked=!1),e.target.previous=e.target.checked})});const y=e=>{v(e)?t.attr("data-original-title","Please validate any error message before proceeding"):t.attr("data-original-title","Please agree to the Terms and Conditions before proceeding")};y(n.val().trim()),s.change(function(){const o=n.val().trim();this.checked&&!v(o)?(e.removeAttr("disabled").removeClass("point-none"),t.tooltip("disable")):(y(o),e.prop("disabled","true").addClass("point-none"),t.tooltip("enable"))}),n.on("input focus",k),e.on("click",e=>{if(s.prop("checked")){const e=Array.from(o).filter(e=>e.checked),t=e.length?e[0].value:"",i=n.val().trim().substring(0,12);if(v(i))return;const s={gender:t,age:a.value,motherTongue:r.value,userName:i};localStorage.setItem("speakerDetails",JSON.stringify(s)),location.href="/record"}}),fetch("/getDetails").then(e=>{if(e.ok)return e.json();throw Error(e.statusText||"HTTP error")}).then(e=>{try{u.addClass("d-none");const t=6*e.find(e=>1===e.index).count,o=Math.floor(t/3600),a=t%3600,r=Math.floor(a/60),n=a%60;h.text(`${o}h ${r}m ${n}s`),p.text(e.find(e=>0===e.index).count),m.removeClass("d-none"),g.removeClass("d-none"),localStorage.setItem("speakersData",JSON.stringify(e))}catch(e){console.log(e)}}).catch(e=>{console.log(e)})});